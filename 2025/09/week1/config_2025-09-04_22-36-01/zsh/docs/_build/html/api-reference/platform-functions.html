

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Platform Functions API Reference &mdash; Siege Analytics ZSH Configuration System 2.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a274b600" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.siegeanalytics.comapi-reference/platform-functions.html"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=20623aea"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=d3ce34c2"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #00FF41" >

          
          
          <a href="../index.html" class="icon icon-home">
            Siege Analytics ZSH Configuration System
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/quick-start.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/configuration.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/troubleshooting.html">Troubleshooting Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Systems</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core-systems/python-management.html">Python Management System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-systems/backup-system.html">Backup System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-systems/help-system.html">Help System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-systems/performance-optimization.html">Performance Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Big Data Integration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../big-data/spark-system.html">Apache Spark Integration System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../big-data/hadoop-integration.html">Hadoop Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../big-data/yarn-management.html">YARN Management</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #00FF41" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Siege Analytics ZSH Configuration System</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Platform Functions API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api-reference/platform-functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="platform-functions-api-reference">
<h1>Platform Functions API Reference<a class="headerlink" href="#platform-functions-api-reference" title="Link to this heading"></a></h1>
<p>This module provides comprehensive cross-shell (bash/zsh) and cross-platform (macOS/Linux/WSL/Docker) compatibility functions, ensuring consistent behavior across different environments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All functions automatically detect the current shell and platform, providing optimal implementations for each environment.</p>
</div>
<section id="shell-detection-functions">
<h2>Shell Detection Functions<a class="headerlink" href="#shell-detection-functions" title="Link to this heading"></a></h2>
<section id="detect-shell">
<h3>detect_shell()<a class="headerlink" href="#detect-shell" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Detect the current shell environment and return the shell name for conditional operations.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>detect_shell<span class="o">()</span>
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic shell detection</span>
<span class="nv">current_shell</span><span class="o">=</span><span class="k">$(</span>detect_shell<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running in: </span><span class="nv">$current_shell</span><span class="s2">&quot;</span>
<span class="c1"># Output (in zsh): Running in: zsh</span>
<span class="c1"># Output (in bash): Running in: bash</span>

<span class="c1"># Conditional shell-specific operations</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>detect_shell<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span><span class="s2">&quot;zsh&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ZSH-specific configuration&quot;</span>
<span class="w">        </span>setopt<span class="w"> </span>autocd
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span><span class="s2">&quot;bash&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Bash-specific configuration&quot;</span>
<span class="w">        </span><span class="nb">shopt</span><span class="w"> </span>-s<span class="w"> </span>autocd
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span>*<span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Unknown shell&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
<p>The function detects shells by checking environment variables:</p>
<ul class="simple">
<li><p><strong>ZSH</strong>: Checks for <cite>$ZSH_VERSION</cite></p></li>
<li><p><strong>Bash</strong>: Checks for <cite>$BASH_VERSION</cite></p></li>
<li><p><strong>Unknown</strong>: Returns “unknown” for other shells</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Shell detection in ZSH</span>
test_detect_shell_zsh<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_VERSION</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>detect_shell<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;zsh&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Skipping ZSH test - not running in ZSH&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Test: Shell detection in Bash</span>
test_detect_shell_bash<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;source shell-compat.zsh; [[ &quot;$(detect_shell)&quot; == &quot;bash&quot; ]]&#39;</span>
<span class="o">}</span>

<span class="c1"># Test: Current shell environment variable</span>
test_current_shell_export<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CURRENT_SHELL</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="platform-detection-functions">
<h2>Platform Detection Functions<a class="headerlink" href="#platform-detection-functions" title="Link to this heading"></a></h2>
<section id="detect-platform">
<h3>detect_platform()<a class="headerlink" href="#detect-platform" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Comprehensive platform detection supporting macOS, multiple Linux distributions, WSL, and Docker containers.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>detect_platform<span class="o">()</span>
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic platform detection</span>
<span class="nv">platform</span><span class="o">=</span><span class="k">$(</span>detect_platform<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running on: </span><span class="nv">$platform</span><span class="s2">&quot;</span>
<span class="c1"># Output examples:</span>
<span class="c1"># Running on: macos</span>
<span class="c1"># Running on: linux-ubuntu</span>
<span class="c1"># Running on: wsl</span>
<span class="c1"># Running on: docker</span>

<span class="c1"># Platform-specific operations</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>detect_platform<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;macOS detected - using Homebrew paths&quot;</span>
<span class="w">        </span>path_add<span class="w"> </span><span class="s2">&quot;/opt/homebrew/bin&quot;</span><span class="w"> </span>before
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span><span class="s2">&quot;linux-debian&quot;</span><span class="p">|</span><span class="s2">&quot;linux-ubuntu&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Debian-based Linux - using apt&quot;</span>
<span class="w">        </span><span class="nb">alias</span><span class="w"> </span><span class="nv">install</span><span class="o">=</span><span class="s2">&quot;sudo apt install&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span><span class="s2">&quot;linux-redhat&quot;</span><span class="p">|</span><span class="s2">&quot;linux-centos&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Red Hat-based Linux - using yum/dnf&quot;</span>
<span class="w">        </span><span class="nb">alias</span><span class="w"> </span><span class="nv">install</span><span class="o">=</span><span class="s2">&quot;sudo dnf install&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span><span class="s2">&quot;docker&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Docker container - optimizing for container&quot;</span>
<span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">SPARK_DRIVER_MEMORY</span><span class="o">=</span><span class="s2">&quot;1g&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span><span class="s2">&quot;wsl&quot;</span><span class="o">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Windows Subsystem for Linux&quot;</span>
<span class="w">        </span><span class="c1"># WSL-specific configurations</span>
<span class="w">        </span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
<p>Platform Detection Logic:</p>
<ol class="arabic simple">
<li><p><strong>macOS</strong>: Checks <cite>uname -s</cite> for “Darwin”</p></li>
<li><p><strong>Linux</strong>: Checks <cite>uname -s</cite> for “Linux”, then reads <cite>/etc/os-release</cite> for distribution</p></li>
<li><p><strong>WSL</strong>: Checks for <cite>$WSL_DISTRO_NAME</cite> or <cite>$WSLENV</cite> environment variables</p></li>
<li><p><strong>Docker</strong>: Checks for <cite>/.dockerenv</cite> file or docker in <cite>/proc/1/cgroup</cite></p></li>
</ol>
<p>Supported platforms:</p>
<ul class="simple">
<li><p><cite>macos</cite> - macOS (Darwin)</p></li>
<li><p><cite>linux</cite> - Generic Linux</p></li>
<li><p><cite>linux-debian</cite> - Debian/Ubuntu</p></li>
<li><p><cite>linux-redhat</cite> - CentOS/RHEL/Fedora</p></li>
<li><p><cite>linux-alpine</cite> - Alpine Linux</p></li>
<li><p><cite>wsl</cite> - Windows Subsystem for Linux</p></li>
<li><p><cite>docker</cite> - Docker containers</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Platform detection returns valid value</span>
test_platform_detection<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">platform</span><span class="o">=</span><span class="k">$(</span>detect_platform<span class="k">)</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$platform</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;unknown&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

<span class="c1"># Test: macOS detection (when on macOS)</span>
test_macos_detection<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>uname<span class="w"> </span>-s<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Darwin&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>detect_platform<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;macos&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Skipping macOS test - not on macOS&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Test: Container detection</span>
test_container_detection<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;/.dockerenv&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>detect_platform<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;docker&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Skipping container test - not in container&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="is-container">
<h3>is_container()<a class="headerlink" href="#is-container" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Detect if the current environment is running inside a Docker container.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>is_container<span class="o">()</span>
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic container detection</span>
<span class="k">if</span><span class="w"> </span>is_container<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running inside a container&quot;</span>
<span class="w">    </span><span class="c1"># Optimize for container environment</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Xmx1g&quot;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">SPARK_DRIVER_MEMORY</span><span class="o">=</span><span class="s2">&quot;512m&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Running on host system&quot;</span>
<span class="w">    </span><span class="c1"># Use full system resources</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">&quot;-Xmx4g&quot;</span>
<span class="k">fi</span>

<span class="c1"># Environment variable usage</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Container status: </span><span class="nv">$ZSH_IS_DOCKER</span><span class="s2">&quot;</span>
<span class="c1"># Output: Container status: true (in container)</span>
<span class="c1"># Output: Container status: false (on host)</span>
</pre></div>
</div>
<p>Container detection methods:</p>
<ol class="arabic simple">
<li><p><strong>Docker env file</strong>: Checks for <cite>/.dockerenv</cite></p></li>
<li><p><strong>Control groups</strong>: Searches for “docker” in <cite>/proc/1/cgroup</cite></p></li>
</ol>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Container detection consistency</span>
test_container_detection_consistency<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">container_function</span><span class="o">=</span><span class="k">$(</span>is_container<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$container_function</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_IS_DOCKER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="cross-shell-compatibility-functions">
<h2>Cross-Shell Compatibility Functions<a class="headerlink" href="#cross-shell-compatibility-functions" title="Link to this heading"></a></h2>
<section id="add-chdir-hook">
<h3>add_chdir_hook()<a class="headerlink" href="#add-chdir-hook" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Add directory change hooks that work consistently across bash and zsh shells.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>add_chdir_hook<span class="w"> </span>&lt;function_name&gt;
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to run on directory change</span>
auto_activate_virtualenv<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.venv/bin/activate&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🐍 Auto-activating virtual environment&quot;</span>
<span class="w">        </span><span class="nb">source</span><span class="w"> </span>.venv/bin/activate
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.python-version&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">local</span><span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span>.python-version<span class="k">)</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🐍 Auto-switching to Python </span><span class="nv">$version</span><span class="s2">&quot;</span>
<span class="w">        </span>pyenv<span class="w"> </span>activate<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$version</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Add the hook (works in both bash and zsh)</span>
add_chdir_hook<span class="w"> </span>auto_activate_virtualenv

<span class="c1"># Now changing directories will trigger the function</span>
<span class="nb">cd</span><span class="w"> </span>my_project<span class="w">  </span><span class="c1"># If it has .venv/, automatically activates it</span>
</pre></div>
</div>
<p>Implementation differences:</p>
<ul class="simple">
<li><p><strong>ZSH</strong>: Uses <cite>add-zsh-hook chpwd</cite> mechanism</p></li>
<li><p><strong>Bash</strong>: Overrides the <cite>cd</cite> function to call the hook</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Hook function is callable</span>
test_chdir_hook_function<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>test_hook<span class="o">()</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;hook called&quot;</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<span class="w">    </span>add_chdir_hook<span class="w"> </span>test_hook
<span class="w">    </span><span class="c1"># Should not error</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="array-handling-functions">
<h2>Array Handling Functions<a class="headerlink" href="#array-handling-functions" title="Link to this heading"></a></h2>
<section id="array-expand">
<h3>array_expand()<a class="headerlink" href="#array-expand" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Cross-shell array expansion that handles the differences between bash and zsh array syntax.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>array_expand<span class="w"> </span>&lt;array_name&gt;
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define arrays in both shells</span>
<span class="c1"># (syntax varies between bash and zsh)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CURRENT_SHELL</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;zsh&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nv">my_array</span><span class="o">=(</span><span class="s2">&quot;item1&quot;</span><span class="w"> </span><span class="s2">&quot;item2&quot;</span><span class="w"> </span><span class="s2">&quot;item3&quot;</span><span class="o">)</span>
<span class="k">else</span>
<span class="w">    </span><span class="nv">my_array</span><span class="o">=(</span><span class="s2">&quot;item1&quot;</span><span class="w"> </span><span class="s2">&quot;item2&quot;</span><span class="w"> </span><span class="s2">&quot;item3&quot;</span><span class="o">)</span>
<span class="k">fi</span>

<span class="c1"># Cross-shell expansion</span>
<span class="nv">expanded</span><span class="o">=</span><span class="k">$(</span>array_expand<span class="w"> </span>my_array<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Array contents: </span><span class="nv">$expanded</span><span class="s2">&quot;</span>
<span class="c1"># Output: Array contents: item1 item2 item3</span>

<span class="c1"># Use in loops</span>
<span class="k">for</span><span class="w"> </span>item<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>array_expand<span class="w"> </span>my_array<span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Processing: </span><span class="nv">$item</span><span class="s2">&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Array expansion works</span>
test_array_expand<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">test_array</span><span class="o">=(</span><span class="s2">&quot;apple&quot;</span><span class="w"> </span><span class="s2">&quot;banana&quot;</span><span class="w"> </span><span class="s2">&quot;cherry&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span><span class="k">$(</span>array_expand<span class="w"> </span>test_array<span class="k">)</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;apple&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;banana&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="assoc-array-set-assoc-array-get">
<h3>assoc_array_set() / assoc_array_get()<a class="headerlink" href="#assoc-array-set-assoc-array-get" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Cross-shell associative array operations that handle the syntax differences between bash and zsh.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>assoc_array_set<span class="w"> </span>&lt;array_name&gt;<span class="w"> </span>&lt;key&gt;<span class="w"> </span>&lt;value&gt;
assoc_array_get<span class="w"> </span>&lt;array_name&gt;<span class="w"> </span>&lt;key&gt;
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up configuration mapping</span>
assoc_array_set<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;database_host&quot;</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span>
assoc_array_set<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;database_port&quot;</span><span class="w"> </span><span class="s2">&quot;5432&quot;</span>
assoc_array_set<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;redis_host&quot;</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span>

<span class="c1"># Retrieve values</span>
<span class="nv">db_host</span><span class="o">=</span><span class="k">$(</span>assoc_array_get<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;database_host&quot;</span><span class="k">)</span>
<span class="nv">db_port</span><span class="o">=</span><span class="k">$(</span>assoc_array_get<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;database_port&quot;</span><span class="k">)</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Database: </span><span class="nv">$db_host</span><span class="s2">:</span><span class="nv">$db_port</span><span class="s2">&quot;</span>
<span class="c1"># Output: Database: localhost:5432</span>

<span class="c1"># Build connection string</span>
build_connection_string<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">host</span><span class="o">=</span><span class="k">$(</span>assoc_array_get<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;database_host&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">port</span><span class="o">=</span><span class="k">$(</span>assoc_array_get<span class="w"> </span>config_map<span class="w"> </span><span class="s2">&quot;database_port&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;postgresql://</span><span class="nv">$host</span><span class="s2">:</span><span class="nv">$port</span><span class="s2">/mydb&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Implementation:</p>
<ul class="simple">
<li><p><strong>ZSH</strong>: Uses <cite>typeset -gA</cite> for global associative arrays</p></li>
<li><p><strong>Bash</strong>: Uses <cite>declare -gA</cite> for global associative arrays</p></li>
<li><p><strong>Fallback</strong>: Uses simple variables with naming convention</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Associative array set/get</span>
test_assoc_array_operations<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>assoc_array_set<span class="w"> </span>test_map<span class="w"> </span><span class="s2">&quot;key1&quot;</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">    </span>assoc_array_set<span class="w"> </span>test_map<span class="w"> </span><span class="s2">&quot;key2&quot;</span><span class="w"> </span><span class="s2">&quot;value2&quot;</span>

<span class="w">    </span><span class="nv">result1</span><span class="o">=</span><span class="k">$(</span>assoc_array_get<span class="w"> </span>test_map<span class="w"> </span><span class="s2">&quot;key1&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="nv">result2</span><span class="o">=</span><span class="k">$(</span>assoc_array_get<span class="w"> </span>test_map<span class="w"> </span><span class="s2">&quot;key2&quot;</span><span class="k">)</span>

<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$result1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$result2</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;value2&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="word-split">
<h3>word_split()<a class="headerlink" href="#word-split" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Handle word splitting differences between bash and zsh for consistent argument processing.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>word_split<span class="w"> </span>&lt;variable&gt;
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define arguments as string</span>
<span class="nv">spark_args</span><span class="o">=</span><span class="s2">&quot;--master local[*] --driver-memory 2g --executor-memory 1g&quot;</span>

<span class="c1"># Cross-shell word splitting</span>
<span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>word_split<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$spark_args</span><span class="s2">&quot;</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Argument: </span><span class="nv">$arg</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="c1"># Output:</span>
<span class="c1"># Argument: --master</span>
<span class="c1"># Argument: local[*]</span>
<span class="c1"># Argument: --driver-memory</span>
<span class="c1"># Argument: 2g</span>
<span class="c1"># Argument: --executor-memory</span>
<span class="c1"># Argument: 1g</span>

<span class="c1"># Use in command execution</span>
spark_submit_with_args<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">args</span><span class="o">=</span><span class="s2">&quot;--master yarn --deploy-mode client&quot;</span>
<span class="w">    </span>spark-submit<span class="w"> </span><span class="k">$(</span>word_split<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$args</span><span class="s2">&quot;</span><span class="k">)</span><span class="w"> </span>my_script.py
<span class="o">}</span>
</pre></div>
</div>
<p>ZSH vs Bash differences:</p>
<ul class="simple">
<li><p><strong>ZSH</strong>: Doesn’t split words by default, requires <cite>${=variable}</cite> syntax</p></li>
<li><p><strong>Bash</strong>: Splits words automatically in unquoted contexts</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Word splitting produces multiple words</span>
test_word_split<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">test_string</span><span class="o">=</span><span class="s2">&quot;word1 word2 word3&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>word<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>word_split<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$test_string</span><span class="s2">&quot;</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="o">((</span>count++<span class="o">))</span>
<span class="w">    </span><span class="k">done</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="nv">$count</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="cross-platform-utilities">
<h2>Cross-Platform Utilities<a class="headerlink" href="#cross-platform-utilities" title="Link to this heading"></a></h2>
<section id="platform-open">
<h3>platform_open()<a class="headerlink" href="#platform-open" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Open files or URLs using the appropriate system command for each platform.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>platform_open<span class="w"> </span>&lt;file_or_url&gt;
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open files with default application</span>
platform_open<span class="w"> </span><span class="s2">&quot;report.pdf&quot;</span>
platform_open<span class="w"> </span><span class="s2">&quot;data.csv&quot;</span>

<span class="c1"># Open URLs in default browser</span>
platform_open<span class="w"> </span><span class="s2">&quot;https://github.com/user/repo&quot;</span>
platform_open<span class="w"> </span><span class="s2">&quot;http://localhost:8080&quot;</span>

<span class="c1"># Open directories</span>
platform_open<span class="w"> </span><span class="s2">&quot;/path/to/project&quot;</span>

<span class="c1"># Use in automation</span>
generate_report<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>python<span class="w"> </span>generate_report.py
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Report generated: report.html&quot;</span>
<span class="w">    </span>platform_open<span class="w"> </span><span class="s2">&quot;report.html&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Platform commands used:</p>
<ul class="simple">
<li><p><strong>macOS</strong>: <cite>open</cite></p></li>
<li><p><strong>Linux</strong>: <cite>xdg-open</cite>, <cite>gnome-open</cite> (fallback)</p></li>
<li><p><strong>WSL</strong>: <cite>cmd.exe /c start</cite></p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Open command exists for platform</span>
test_platform_open_command<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>open<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;linux&quot;</span>*<span class="o">)</span>
<span class="w">            </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>xdg-open<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>gnome-open<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;wsl&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>cmd.exe<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>*<span class="o">)</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Unknown platform for testing: </span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="platform-copy-platform-paste">
<h3>platform_copy() / platform_paste()<a class="headerlink" href="#platform-copy-platform-paste" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Cross-platform clipboard operations for copying and pasting text.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>platform_copy<span class="w">      </span><span class="c1"># Copy from stdin</span>
platform_paste<span class="w">     </span><span class="c1"># Paste to stdout</span>
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy text to clipboard</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello, World!&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy

<span class="c1"># Copy file contents</span>
cat<span class="w"> </span>important_config.yml<span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy

<span class="c1"># Paste from clipboard</span>
<span class="nv">clipboard_content</span><span class="o">=</span><span class="k">$(</span>platform_paste<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Clipboard: </span><span class="nv">$clipboard_content</span><span class="s2">&quot;</span>

<span class="c1"># Use in workflows</span>
copy_connection_string<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">host</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">port</span><span class="o">=</span><span class="nv">$2</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">database</span><span class="o">=</span><span class="nv">$3</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;postgresql://</span><span class="nv">$host</span><span class="s2">:</span><span class="nv">$port</span><span class="s2">/</span><span class="nv">$database</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Connection string copied to clipboard&quot;</span>
<span class="o">}</span>

<span class="c1"># Copy command output</span>
get_system_info<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>system_info<span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;System information copied to clipboard&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Platform implementations:</p>
<ul class="simple">
<li><p><strong>macOS</strong>: <cite>pbcopy</cite> / <cite>pbpaste</cite></p></li>
<li><p><strong>Linux</strong>: <cite>xclip</cite> or <cite>xsel</cite> (requires installation)</p></li>
<li><p><strong>WSL</strong>: <cite>clip.exe</cite> / <cite>powershell.exe Get-Clipboard</cite></p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Copy and paste round-trip</span>
test_clipboard_round_trip<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">test_string</span><span class="o">=</span><span class="s2">&quot;test clipboard functionality&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$test_string</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">pasted</span><span class="o">=</span><span class="k">$(</span>platform_paste<span class="k">)</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$pasted</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;</span><span class="nv">$test_string</span><span class="s2">&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

<span class="c1"># Test: Clipboard commands exist</span>
test_clipboard_commands_exist<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>pbcopy<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>pbpaste<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;linux&quot;</span>*<span class="o">)</span>
<span class="w">            </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>xclip<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>xsel<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;wsl&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>clip.exe<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>*<span class="o">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="c1"># Skip for unknown platforms</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="path-management-functions">
<h2>Path Management Functions<a class="headerlink" href="#path-management-functions" title="Link to this heading"></a></h2>
<section id="path-add">
<h3>path_add()<a class="headerlink" href="#path-add" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Add directories to PATH with duplicate checking and position control.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>path_add<span class="w"> </span>&lt;directory&gt;<span class="w"> </span><span class="o">[</span>before<span class="p">|</span>after<span class="o">]</span>
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add to end of PATH (default)</span>
path_add<span class="w"> </span><span class="s2">&quot;/usr/local/bin&quot;</span>
path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.local/bin&quot;</span>

<span class="c1"># Add to beginning of PATH (higher priority)</span>
path_add<span class="w"> </span><span class="s2">&quot;/opt/homebrew/bin&quot;</span><span class="w"> </span>before

<span class="c1"># Conditional path addition</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/opt/spark/bin&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>path_add<span class="w"> </span><span class="s2">&quot;/opt/spark/bin&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Spark added to PATH&quot;</span>
<span class="k">fi</span>

<span class="c1"># Add multiple paths</span>
<span class="nv">python_paths</span><span class="o">=(</span>
<span class="w">    </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.pyenv/bin&quot;</span>
<span class="w">    </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.local/bin&quot;</span>
<span class="w">    </span><span class="s2">&quot;/opt/python/bin&quot;</span>
<span class="o">)</span>

<span class="k">for</span><span class="w"> </span>py_path<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">python_paths</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$py_path</span><span class="s2">&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Features:</p>
<ul class="simple">
<li><p><strong>Duplicate prevention</strong>: Won’t add paths already in PATH</p></li>
<li><p><strong>Existence checking</strong>: Only adds existing directories</p></li>
<li><p><strong>Position control</strong>: Add at beginning or end of PATH</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Path addition (non-duplicate)</span>
test_path_add_new<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># Create temporary directory</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">temp_dir</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="w"> </span>-d<span class="k">)</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">original_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PATH</span><span class="s2">&quot;</span>

<span class="w">    </span>path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$temp_dir</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;:</span><span class="nv">$PATH</span><span class="s2">:&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;:</span><span class="nv">$temp_dir</span><span class="s2">:&quot;</span>*<span class="w"> </span><span class="o">]]</span>

<span class="w">    </span><span class="c1"># Cleanup</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$original_path</span><span class="s2">&quot;</span>
<span class="w">    </span>rmdir<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$temp_dir</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Test: Duplicate prevention</span>
test_path_add_duplicate<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">original_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PATH</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">path_count_before</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PATH</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span>

<span class="w">    </span>path_add<span class="w"> </span><span class="s2">&quot;/usr/bin&quot;</span><span class="w">  </span><span class="c1"># Already exists</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">path_count_after</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PATH</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span>

<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="nv">$path_count_before</span><span class="w"> </span>-eq<span class="w"> </span><span class="nv">$path_count_after</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="lib-path-add">
<h3>lib_path_add()<a class="headerlink" href="#lib-path-add" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Add directories to library path using the appropriate environment variable for each platform.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lib_path_add<span class="w"> </span>&lt;library_directory&gt;
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add custom library paths</span>
lib_path_add<span class="w"> </span><span class="s2">&quot;/usr/local/lib&quot;</span>
lib_path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/local/lib&quot;</span>

<span class="c1"># Add Java/JNI libraries</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JAVA_HOME</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>lib_path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JAVA_HOME</span><span class="s2">/lib&quot;</span>
<span class="w">    </span>lib_path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JAVA_HOME</span><span class="s2">/jre/lib&quot;</span>
<span class="k">fi</span>

<span class="c1"># Add Spark/Hadoop native libraries</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SPARK_HOME</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>lib_path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SPARK_HOME</span><span class="s2">/lib&quot;</span>
<span class="k">fi</span>

<span class="c1"># Platform-specific library setup</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">        </span>lib_path_add<span class="w"> </span><span class="s2">&quot;/opt/homebrew/lib&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="w">    </span><span class="s2">&quot;linux&quot;</span>*<span class="o">)</span>
<span class="w">        </span>lib_path_add<span class="w"> </span><span class="s2">&quot;/usr/lib64&quot;</span>
<span class="w">        </span>lib_path_add<span class="w"> </span><span class="s2">&quot;/usr/lib/x86_64-linux-gnu&quot;</span>
<span class="w">        </span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
<p>Platform-specific variables:</p>
<ul class="simple">
<li><p><strong>macOS</strong>: Uses <cite>DYLD_LIBRARY_PATH</cite> (Note: restricted by SIP in some cases)</p></li>
<li><p><strong>Linux/WSL/Docker</strong>: Uses <cite>LD_LIBRARY_PATH</cite></p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Library path setting</span>
test_lib_path_add<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># Create temporary directory</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">temp_lib</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="w"> </span>-d<span class="k">)</span>

<span class="w">    </span>lib_path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$temp_lib</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;:</span><span class="si">${</span><span class="nv">DYLD_LIBRARY_PATH</span><span class="k">:-</span><span class="si">}</span><span class="s2">:&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;:</span><span class="nv">$temp_lib</span><span class="s2">:&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;linux&quot;</span>*<span class="p">|</span><span class="s2">&quot;wsl&quot;</span><span class="p">|</span><span class="s2">&quot;docker&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;:</span><span class="si">${</span><span class="nv">LD_LIBRARY_PATH</span><span class="k">:-</span><span class="si">}</span><span class="s2">:&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;:</span><span class="nv">$temp_lib</span><span class="s2">:&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>

<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span><span class="nv">$?</span>
<span class="w">    </span>rmdir<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$temp_lib</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span><span class="nv">$result</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="package-manager-detection">
<h2>Package Manager Detection<a class="headerlink" href="#package-manager-detection" title="Link to this heading"></a></h2>
<section id="detect-package-managers">
<h3>detect_package_managers()<a class="headerlink" href="#detect-package-managers" title="Link to this heading"></a></h3>
<p><strong>Function Definition:</strong></p>
<p>Detect all available package managers on the system for automated installation scripts.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>detect_package_managers<span class="o">()</span>
</pre></div>
</div>
<p><strong>Examples and Elaboration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get all available package managers</span>
<span class="nv">available_managers</span><span class="o">=</span><span class="k">$(</span>detect_package_managers<span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Available package managers: </span><span class="nv">$available_managers</span><span class="s2">&quot;</span>
<span class="c1"># Example output: Available package managers: brew npm pip uv</span>

<span class="c1"># Use in installation scripts</span>
install_python_deps<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">managers</span><span class="o">=</span><span class="k">$(</span>detect_package_managers<span class="k">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;uv&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Using UV for Python dependencies&quot;</span>
<span class="w">        </span>uv<span class="w"> </span>add<span class="w"> </span>pandas<span class="w"> </span>numpy<span class="w"> </span>matplotlib
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;pip&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Using pip for Python dependencies&quot;</span>
<span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>pandas<span class="w"> </span>numpy<span class="w"> </span>matplotlib
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ No Python package manager found&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># System package installation</span>
install_system_package<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">package</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">managers</span><span class="o">=</span><span class="k">$(</span>detect_package_managers<span class="k">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;brew&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>brew<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$package</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;apt&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$package</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;dnf&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$package</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;yum&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$package</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ No suitable package manager found for </span><span class="nv">$package</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Detected package managers:</p>
<p><strong>System Package Managers:</strong></p>
<ul class="simple">
<li><p><cite>apt</cite> - Debian/Ubuntu</p></li>
<li><p><cite>yum</cite> - CentOS/RHEL (older)</p></li>
<li><p><cite>dnf</cite> - Fedora/CentOS/RHEL (newer)</p></li>
<li><p><cite>pacman</cite> - Arch Linux</p></li>
<li><p><cite>brew</cite> - macOS/Linux Homebrew</p></li>
</ul>
<p><strong>Development Package Managers:</strong></p>
<ul class="simple">
<li><p><cite>npm</cite> - Node.js packages</p></li>
<li><p><cite>pip</cite> - Python packages</p></li>
<li><p><cite>uv</cite> - Modern Python package manager</p></li>
</ul>
<p><strong>Unit Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test: Package manager detection returns list</span>
test_package_manager_detection<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">managers</span><span class="o">=</span><span class="k">$(</span>detect_package_managers<span class="k">)</span>
<span class="w">    </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w">  </span><span class="c1"># Should return something</span>
<span class="o">}</span>

<span class="c1"># Test: Known package managers are detected</span>
test_known_package_managers<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">managers</span><span class="o">=</span><span class="k">$(</span>detect_package_managers<span class="k">)</span>

<span class="w">    </span><span class="c1"># Test for commonly available tools</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>pip<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$managers</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;pip&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="environment-variables-and-status">
<h2>Environment Variables and Status<a class="headerlink" href="#environment-variables-and-status" title="Link to this heading"></a></h2>
<p>The module exports several environment variables for use by other modules:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shell information</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Current shell: </span><span class="nv">$CURRENT_SHELL</span><span class="s2">&quot;</span><span class="w">                    </span><span class="c1"># zsh, bash, or unknown</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Platform: </span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w">                         </span><span class="c1"># macos, linux, wsl, docker, etc.</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Container: </span><span class="nv">$ZSH_IS_DOCKER</span><span class="s2">&quot;</span><span class="w">                       </span><span class="c1"># true or false</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Package managers: </span><span class="nv">$AVAILABLE_PACKAGE_MANAGERS</span><span class="s2">&quot;</span><span class="w">   </span><span class="c1"># Space-separated list</span>

<span class="c1"># Module information</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Module loaded: </span><span class="nv">$SHELL_COMPAT_MODULE_LOADED</span><span class="s2">&quot;</span><span class="w">      </span><span class="c1"># true</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Module version: </span><span class="nv">$SHELL_COMPAT_MODULE_VERSION</span><span class="s2">&quot;</span><span class="w">    </span><span class="c1"># 1.0.0</span>
</pre></div>
</div>
</section>
<section id="complete-usage-examples">
<h2>Complete Usage Examples<a class="headerlink" href="#complete-usage-examples" title="Link to this heading"></a></h2>
<p><strong>Example 1: Cross-platform development environment setup</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Platform-aware Python environment setup</span>
setup_python_environment<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🔧 Setting up Python environment for </span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="c1"># macOS: Use Homebrew Python</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>brew<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span>brew<span class="w"> </span>install<span class="w"> </span>python
<span class="w">                </span>path_add<span class="w"> </span><span class="s2">&quot;/opt/homebrew/bin&quot;</span><span class="w"> </span>before
<span class="w">            </span><span class="k">fi</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;linux-debian&quot;</span><span class="p">|</span><span class="s2">&quot;linux-ubuntu&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="c1"># Ubuntu/Debian: Use system package manager</span>
<span class="w">            </span>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-venv
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;linux-redhat&quot;</span><span class="p">|</span><span class="s2">&quot;linux-centos&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="c1"># Red Hat: Use dnf/yum</span>
<span class="w">            </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-venv
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span><span class="s2">&quot;docker&quot;</span><span class="o">)</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ℹ️  Using pre-installed Python in container&quot;</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>

<span class="w">    </span><span class="c1"># Add common Python paths</span>
<span class="w">    </span>path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.local/bin&quot;</span>

<span class="w">    </span><span class="c1"># Install UV if available</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>is_online<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>uv<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
<span class="w">        </span>path_add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.cargo/bin&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</pre></div>
</div>
<p><strong>Example 2: Cross-shell hook system</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Auto-activate environments on directory change</span>
setup_auto_activation<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>auto_env_activate<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="c1"># Check for UV project</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;pyproject.toml&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;.venv&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$VIRTUAL_ENV</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">/.venv&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚡ Activating UV environment&quot;</span>
<span class="w">                </span><span class="nb">source</span><span class="w"> </span>.venv/bin/activate
<span class="w">            </span><span class="k">fi</span>
<span class="w">        </span><span class="c1"># Check for PyEnv version file</span>
<span class="w">        </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.python-version&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">local</span><span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span>.python-version<span class="k">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>pyenv<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🐍 Switching to Python </span><span class="nv">$version</span><span class="s2">&quot;</span>
<span class="w">                </span>pyenv<span class="w"> </span>activate<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$version</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null
<span class="w">            </span><span class="k">fi</span>
<span class="w">        </span><span class="c1"># Check for Node.js project</span>
<span class="w">        </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;package.json&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;node_modules&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;📦 Node.js project detected&quot;</span>
<span class="w">            </span><span class="c1"># Could add nvm activation here</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span><span class="c1"># Add hook for both shells</span>
<span class="w">    </span>add_chdir_hook<span class="w"> </span>auto_env_activate
<span class="o">}</span>
</pre></div>
</div>
<p><strong>Example 3: Cross-platform clipboard integration</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enhanced clipboard utilities</span>
copy_file<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>cat<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ </span><span class="nv">$file</span><span class="s2"> copied to clipboard&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ File not found: </span><span class="nv">$file</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

copy_directory_tree<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>find<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.py&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-10<span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Python files list copied to clipboard&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

copy_git_info<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">info</span><span class="o">=</span><span class="s2">&quot;Repository: </span><span class="k">$(</span>basename<span class="w"> </span><span class="k">$(</span>git<span class="w"> </span>rev-parse<span class="w"> </span>--show-toplevel<span class="k">)</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Not a git repo&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="s1">$&#39;\n&#39;</span>
<span class="w">    </span><span class="nv">info</span><span class="o">+=</span><span class="s2">&quot;Branch: </span><span class="k">$(</span>git<span class="w"> </span>branch<span class="w"> </span>--show-current<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;No branch&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="s1">$&#39;\n&#39;</span>
<span class="w">    </span><span class="nv">info</span><span class="o">+=</span><span class="s2">&quot;Commit: </span><span class="k">$(</span>git<span class="w"> </span>rev-parse<span class="w"> </span>--short<span class="w"> </span>HEAD<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;No commits&#39;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$info</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>platform_copy
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Git information copied to clipboard&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="integration-with-other-modules">
<h2>Integration with Other Modules<a class="headerlink" href="#integration-with-other-modules" title="Link to this heading"></a></h2>
<p><strong>Module Loading Order:</strong></p>
<p>The shell-compat module should be loaded first, as other modules depend on its functions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># In main zshrc</span>
<span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.config/zsh/config/shell-compat.zsh&quot;</span><span class="w">  </span><span class="c1"># Load first</span>
<span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.config/zsh/config/core.zsh&quot;</span><span class="w">         </span><span class="c1"># Can use platform functions</span>
<span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.config/zsh/config/spark.zsh&quot;</span><span class="w">        </span><span class="c1"># Can use cross-shell arrays</span>
</pre></div>
</div>
<p><strong>With Core Module:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Core module uses platform detection</span>
mkcd<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># Platform-specific notification</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ZSH_PLATFORM</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span><span class="s2">&quot;macos&quot;</span><span class="o">)</span>
<span class="w">            </span>osascript<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;display notification &#39;Created directory: </span><span class="nv">$1</span><span class="s2">&#39; with title &#39;Shell&#39;&quot;</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>*<span class="o">)</span>
<span class="w">            </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;📁 Created and entered: </span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="o">}</span>
</pre></div>
</div>
<p><strong>With Spark Module:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spark module uses cross-shell word splitting</span>
get_spark_dependencies<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">dependencies</span><span class="o">=</span><span class="s2">&quot;--packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.0&quot;</span>

<span class="w">    </span><span class="c1"># Cross-shell compatible argument parsing</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="k">$(</span>word_split<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dependencies</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This comprehensive platform compatibility layer ensures that all shell functions work consistently across different operating systems and shell environments, providing a solid foundation for the entire modular configuration system.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Siege Analytics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>